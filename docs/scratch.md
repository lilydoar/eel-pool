
# Mon Jul 28 2025 - 1

ps aux
USER               PID  %CPU %MEM      VSZ    RSS   TT  STAT STARTED      TIME COMMAND
lily             28933 141.3  3.5 418034560 581600   ??  R     8:53PM   4:24.91 /Users/lily/Library/Application Support/Steam/steamapps/common/Hades II/Hade
lily             85572  98.8  0.0 410874832    112   ??  R    Sun04PM 566:33.83 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             85558  98.4  0.0 410857424    112   ??  R    Sun04PM 566:36.03 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83005  18.4  0.0 410857424    128   ??  R    Sun04PM  50:21.26 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81857  15.3  0.0 410857424    112   ??  R    Sun04PM  50:48.33 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             29151  12.7  0.1 426950928   8688   ??  R     8:56PM   0:00.05 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             29152  12.7  0.1 426950928   8672   ??  R     8:56PM   0:00.05 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             82307  11.7  0.0 410857424    112   ??  R    Sun04PM  50:41.01 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82397  11.3  0.0 410857424    112   ??  R    Sun04PM  50:37.52 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81917  10.9  0.0 410857424    112   ??  R    Sun04PM  50:48.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82822  10.3  0.0 410857424    112   ??  R    Sun04PM  50:23.81 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81845  10.2  0.0 410857424    112   ??  R    Sun04PM  50:45.64 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82733   9.9  0.0 410857424    112   ??  R    Sun04PM  50:32.17 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82868   9.9  0.0 410725328    112   ??  R    Sun04PM  50:24.59 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82990   9.7  0.0 410857424    112   ??  R    Sun04PM  50:19.21 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83118   9.6  0.0 410857424    112   ??  R    Sun04PM  50:21.84 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82295   9.6  0.0 410857424    128   ??  R    Sun04PM  50:40.30 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83190   9.4  0.0 410857424    112   ??  R    Sun04PM  50:17.77 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82512   9.3  0.0 410866640    112   ??  R    Sun04PM  50:30.02 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82472   9.1  0.0 410883024    128   ??  R    Sun04PM  50:36.79 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81809   9.1  0.0 410997712    128   ??  R    Sun04PM  50:56.12 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81953   8.8  0.0 410866640    112   ??  R    Sun04PM  50:45.19 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82361   8.6  0.0 410857424    112   ??  R    Sun04PM  50:39.79 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82484   8.6  0.0 411016144    112   ??  R    Sun04PM  50:32.79 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84971   8.4  0.0 410857424    112   ??  R    Sun04PM  49:20.34 /Users/lily/Documents/repos/eel-pool/bin/test/tests
root               121   8.4  0.3 427054752  51968   ??  Rs   13Jul25  58:40.37 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             82283   8.4  0.0 410857424     80   ??  R    Sun04PM  50:40.54 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82347   8.3  0.0 410997712    112   ??  R    Sun04PM  50:39.24 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81929   8.2  0.0 410857424    112   ??  R    Sun04PM  50:43.75 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82681   8.1  0.0 410857424    112   ??  R    Sun04PM  50:28.01 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82757   8.0  0.0 410857424    112   ??  R    Sun04PM  50:23.57 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81697   7.9  0.0 410725328    112   ??  R    Sun04PM  50:53.14 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81737   7.9  0.0 410988496    112   ??  R    Sun04PM  50:55.23 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81989   7.9  0.0 410725328    112   ??  R    Sun04PM  50:44.47 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83100   7.8  0.0 410988496    112   ??  R    Sun04PM  50:21.76 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83021   7.8  0.0 410857424    112   ??  R    Sun04PM  50:21.63 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82786   7.8  0.0 410865616    112   ??  R    Sun04PM  50:24.21 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82421   7.8  0.0 410857424    112   ??  R    Sun04PM  50:40.81 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82552   7.7  0.0 410725328    112   ??  R    Sun04PM  50:30.42 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83149   7.6  0.0 410856400    112   ??  R    Sun04PM  50:20.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82665   7.6  0.0 410857424    112   ??  R    Sun04PM  50:32.07 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81725   7.5  0.0 410857424    128   ??  R    Sun04PM  50:55.87 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84593   7.5  0.0 410857424    304   ??  R    Sun04PM  60:23.30 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82907   7.5  0.0 410857424    112   ??  R    Sun04PM  50:26.93 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84817   7.5  0.0 410857424    352   ??  R    Sun04PM  60:27.75 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84623   7.5  0.0 410857424    288   ??  R    Sun04PM  60:24.32 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81749   7.5  0.0 410997712    112   ??  R    Sun04PM  50:56.47 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84649   7.5  0.0 410857424    320   ??  R    Sun04PM  60:26.46 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84879   7.4  0.0 410857424    336   ??  R    Sun04PM  60:12.06 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82331   7.4  0.0 410857424    112   ??  R    Sun04PM  50:39.97 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84751   7.3  0.0 410857424    320   ??  R    Sun04PM  60:23.03 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84930   7.3  0.0 410857424    320   ??  R    Sun04PM  60:22.61 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84675   7.3  0.0 410857424    304   ??  R    Sun04PM  60:23.80 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84781   7.3  0.0 410857424    336   ??  R    Sun04PM  60:23.38 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84704   7.3  0.0 410857424    320   ??  R    Sun04PM  60:15.71 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82568   7.3  0.0 410988496    112   ??  R    Sun04PM  50:27.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83725   7.3  0.0 410857424    112   ??  R    Sun04PM  49:34.60 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83742   7.2  0.0 410725328    112   ??  R    Sun04PM  49:28.87 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82957   6.4  0.0 410988496    112   ??  R    Sun04PM  50:18.03 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             29126   6.3  0.1 426958048   9104   ??  S     8:56PM   0:00.05 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             84567   6.2  0.0 410857424    336   ??  R    Sun04PM  60:22.00 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83539   6.1  0.0 410856400    112   ??  R    Sun04PM  49:34.08 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82810   6.0  0.0 410857424    112   ??  R    Sun04PM  50:22.27 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81869   6.0  0.0 410857424     80   ??  R    Sun04PM  50:43.92 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82524   5.8  0.0 410857424    112   ??  R    Sun04PM  50:34.69 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82385   5.8  0.0 410988496    112   ??  R    Sun04PM  50:39.47 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83697   5.7  0.0 410857424    112   ??  R    Sun04PM  49:27.47 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81881   5.7  0.0 410857424    112   ??  R    Sun04PM  50:45.74 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83064   5.7  0.0 410988496    112   ??  R    Sun04PM  50:20.32 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82319   5.6  0.0 410857424    112   ??  R    Sun04PM  50:39.70 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82652   5.6  0.0 410857424    112   ??  R    Sun04PM  50:27.59 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82798   5.6  0.0 410997712    112   ??  R    Sun04PM  50:28.38 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83076   5.5  0.0 410857424    112   ??  R    Sun04PM  50:17.81 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83734   5.5  0.0 410857424    112   ??  R    Sun04PM  49:33.64 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82770   5.5  0.0 410857424    112   ??  R    Sun04PM  50:28.42 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82053   5.5  0.0 410857424    112   ??  R    Sun04PM  50:39.73 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83556   5.5  0.0 410857424    112   ??  R    Sun04PM  49:35.82 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83717   5.4  0.0 410866640    112   ??  R    Sun04PM  49:30.79 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82709   5.3  0.0 410857424    128   ??  R    Sun04PM  50:29.59 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82931   5.3  0.0 411006928    112   ??  R    Sun04PM  50:23.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82269   5.2  0.0 411005904    112   ??  R    Sun04PM  50:42.17 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82433   5.1  0.0 410866640    112   ??  R    Sun04PM  50:39.75 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81833   5.1  0.0 410857424    112   ??  R    Sun04PM  50:51.65 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82854   5.1  0.0 410857424    112   ??  R    Sun04PM  50:20.06 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81773   5.0  0.0 410857424    112   ??  R    Sun04PM  50:56.95 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82593   5.0  0.0 410857424    112   ??  R    Sun04PM  50:38.02 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82919   4.8  0.0 410857424    128   ??  R    Sun04PM  50:20.65 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83588   4.8  0.0 410857424    112   ??  R    Sun04PM  49:32.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81941   4.8  0.0 410997712    112   ??  R    Sun04PM  50:46.65 /Users/lily/Documents/repos/eel-pool/bin/test/tests
_coreaudiod        187   4.8  0.1 427025232  22400   ??  Ss   13Jul25 520:05.53 /usr/sbin/coreaudiod
lily             82001   4.6  0.0 410857424    128   ??  R    Sun04PM  50:44.78 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82040   4.6  0.0 410857424    112   ??  R    Sun04PM  50:46.55 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81893   4.6  0.0 410857424    112   ??  R    Sun04PM  50:45.16 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81821   4.5  0.0 410857424    112   ??  R    Sun04PM  50:51.48 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83681   4.5  0.0 410874832    112   ??  R    Sun04PM  49:27.82 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83088   4.3  0.0 410857424    112   ??  R    Sun04PM  50:25.34 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81761   4.3  0.0 410857424    112   ??  R    Sun04PM  50:54.36 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83136   4.3  0.0 410997712    112   ??  R    Sun04PM  50:17.98 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81965   4.2  0.0 410857424    112   ??  R    Sun04PM  50:49.85 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81977   4.1  0.0 410857424    112   ??  R    Sun04PM  50:42.24 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             29125   4.1  0.1 426958048   9120   ??  S     8:56PM   0:00.05 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             83576   4.1  0.0 410857424    128   ??  R    Sun04PM  49:28.87 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82943   4.1  0.0 410857424    112   ??  R    Sun04PM  50:19.93 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83034   4.1  0.0 410857424    128   ??  R    Sun04PM  50:25.25 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82014   4.0  0.0 410865616    112   ??  R    Sun04PM  50:43.32 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82745   4.0  0.0 410857424    112   ??  R    Sun04PM  50:29.95 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82622   3.9  0.0 410866640    112   ??  R    Sun04PM  50:33.21 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83689   3.9  0.0 410997712    112   ??  R    Sun04PM  49:30.99 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83564   3.9  0.0 410857424    112   ??  R    Sun04PM  49:30.80 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82887   3.9  0.0 410857424    112   ??  R    Sun04PM  50:24.67 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82637   3.9  0.0 410857424    112   ??  R    Sun04PM  50:33.44 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82580   3.9  0.0 410857424    128   ??  R    Sun04PM  50:30.28 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82028   3.9  0.0 410857424    112   ??  R    Sun04PM  50:43.77 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81797   3.9  0.0 410988496    128   ??  R    Sun04PM  50:56.75 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81713   3.9  0.0 410988496    112   ??  R    Sun04PM  50:54.81 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82452   3.7  0.0 410857424     80   ??  R    Sun04PM  50:35.13 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82970   3.7  0.0 410857424    112   ??  R    Sun04PM  50:23.12 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82409   3.7  0.0 410725328    112   ??  R    Sun04PM  50:37.55 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82500   3.7  0.0 410997712    128   ??  R    Sun04PM  50:34.97 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83166   3.6  0.0 410857424    112   ??  R    Sun04PM  50:19.25 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82373   3.6  0.0 410857424    128   ??  R    Sun04PM  50:41.98 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81905   3.6  0.0 410857424    128   ??  R    Sun04PM  50:42.95 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82834   3.6  0.0 410725328    112   ??  R    Sun04PM  50:23.41 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83050   3.5  0.0 410857424    112   ??  R    Sun04PM  50:20.77 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83178   3.4  0.0 410857424    112   ??  R    Sun04PM  50:19.15 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81785   3.4  0.0 411006928    112   ??  R    Sun04PM  50:57.35 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82697   3.4  0.0 410997712    112   ??  R    Sun04PM  50:24.77 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82609   3.3  0.0 410857424    112   ??  R    Sun04PM  50:30.21 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82721   3.2  0.0 410725328    112   ??  R    Sun04PM  50:24.89 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82536   3.2  0.0 410857424    112   ??  R    Sun04PM  50:32.95 /Users/lily/Documents/repos/eel-pool/bin/test/tests
...
lily             85567   0.0  0.0 412883888     16   ??  S    Sun04PM   0:01.10 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             85552   0.0  0.0 412899312     16   ??  S    Sun04PM   0:01.05 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84933   0.0  0.0 412886176     16   ??  S    Sun04PM   0:01.05 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84882   0.0  0.0 412902624     16   ??  S    Sun04PM   0:01.28 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84820   0.0  0.0 412885120     16   ??  S    Sun04PM   0:01.22 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84785   0.0  0.0 412919040     16   ??  S    Sun04PM   0:01.13 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84754   0.0  0.0 412894400     16   ??  S    Sun04PM   0:01.26 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84725   0.0  0.0 412911872     16   ??  S    Sun04PM   0:01.21 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84681   0.0  0.0 412901600     16   ??  S    Sun04PM   0:01.21 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84652   0.0  0.0 412893376     16   ??  S    Sun04PM   0:01.20 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84626   0.0  0.0 412895392     16   ??  S    Sun04PM   0:01.10 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84599   0.0  0.0 412919040     16   ??  S    Sun04PM   0:01.12 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84570   0.0  0.0 412901600     16   ??  S    Sun04PM   0:01.15 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84544   0.0  0.0 412900544     16   ??  S    Sun04PM   0:01.13 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors

## Explanation

I accidentally ran a bunch of tests that failed to close all of their processes.

Part of the testing process needs to be a fail safe cleanup process that
identifies any processes "left behind" and records them to mark as failures.
Threads that did not respond to the stop signal.

TODO: Identify all processes that are started by a process and record them in a durable manner.
Check that all threads exit when they are told to.

TODO: Improve test process with a checker for leaked processes.
Or maybe put all executed processes into a registry?

# Tue Jul 29 2025 - 1

Today the game thread hung before completing a single iteration. Just a total deadlock.
And that's exactly what it was. A Mutex deadlock. I'm familiar with the tenants of Mutexes:

- lock when performing a write

- no lock required when reading

- minimize surface area of the lock interactions

But, this was a failure case I had not seen before and thus did not know to look for.
A function took a lock and then called a function that took another lock.
Duh. Of course that would never work. The second lock will wait forever because
it's waiting on an unlock that is guaranteed to occur after it.
This must be an extremely classic failure case that occurs when an API doesn't
keep track of it's current lock state/share the lock across a call chain.
But somehow I didn't know it before today. Maybe I'd heard it before, but it
definitely didn't stick.

> TIL:
> Don't call a function that locks the same mutex that is locked within the
> current scope. In other words, mutex lock/unlock scopes don't nest by default.
> without shared checks, the program doesn't know it's entering a deadlocked
> state even though it's guaranteed. Could this be fixed with a lil bit o
> metaprogramming. Could fix this with a "local" global variable.

TODO: Start a timer for a single successful iteration of a thread loop. If it
does not complete the first iteration within some time period, then mark the
thread job as a failure and kill the thread. This will be a crucial tool in
validating thread behavior for testing.

# Wed Jul 30 2025 - 1

## Advanced Build System Design - Profile-Based Workflow Orchestration

This design session explored a powerful build configuration system that goes far
beyond traditional compilation - it orchestrates entire development and release
workflows through composable "profiles."

### Core Concepts

**Profiles as Workflow Orchestrators**: Rather than just building code, profiles
define complete end-to-end processes - from building and testing to generating
marketing materials, updating websites, and communicating with communities.

**Action-Step Architecture**: Each profile consists of structured steps that
invoke well-defined actions. Actions have explicit parameter schemas,
dependencies, and data flow contracts.

**Context Flow Between Steps**: Steps can consume outputs from previous steps
through a variable substitution system (`${step_id.output_var}`), enabling
complex data pipelines.

**Declarative Dependencies**: Explicit `depends_on` relationships ensure proper
execution order while enabling parallelization where possible.

### Patterns and Creative Use Cases

**Release Pipeline Orchestration**: Complete release workflows that build, test,
package, generate changelogs, capture screenshots, deploy websites, and notify
communities - all in a single profile execution.

**Content Marketing Automation**: Profiles that build demo versions, capture
promotional screenshots, extract trailer footage, and prepare press kits for
marketing campaigns.

**Community Communication Workflows**: Rich Discord integration for everything
from major release announcements with embeds and threads to urgent hotfix
notifications and scheduled development updates.

**Environment-Specific Configurations**: Different build targets (release,
develop, demo, prototype) with their own optimization settings, feature flags,
and asset bundles.

### Schema Evolution

The design evolved through three key refinements:

1. **Structured Action Parameters**: Moving from simple action strings to rich parameter schemas with validation and IDE support.

2. **Step Dependencies and Context Flow**: Adding explicit dependencies and data passing between steps to enable complex workflows.

3. **Discord-Specific Actions**: Specialized actions for community engagement, demonstrating how the system can extend into any domain.

### Final Schema Design

```json
{
  "action_definitions": {
    "build": {
      "params": ["targets", "watch", "incremental"],
      "required": ["targets"],
      "provides": ["build_path", "version", "artifacts"]
    },
    "screenshot": {
      "params": ["scenes", "resolution", "output_dir", "format"],
      "required": ["scenes"],
      "depends_on": ["build"],
      "provides": ["screenshots_path", "screenshot_count"]
    },
    "discord_post": {
      "params": ["channel", "message", "embeds", "files", "thread_name"],
      "required": ["channel", "message"],
      "context_vars": ["version", "changelog_path", "screenshots_path"],
      "provides": ["message_id", "message_url"]
    },
    "package": {
      "params": ["format", "include_docs", "branding", "compression"],
      "required": ["format"],
      "context_vars": ["build_path", "changelog_path", "screenshots_path"],
      "provides": ["package_path", "package_size"]
    }
  },
  "profiles": {
    "release-full": {
      "description": "Complete release pipeline: build, validate, package",
      "steps": [
        {
          "id": "build_release",
          "action": "build",
          "targets": ["release"]
        },
        {
          "id": "capture_screenshots",
          "action": "screenshot",
          "depends_on": ["build_release"],
          "scenes": ["main_menu", "gameplay"],
          "resolution": "1920x1080",
          "output_dir": "release_assets/"
        },
        {
          "id": "create_package",
          "action": "package",
          "depends_on": ["build_release", "capture_screenshots"],
          "format": "zip",
          "context": {
            "build_path": "${build_release.build_path}",
            "screenshots_path": "${capture_screenshots.screenshots_path}"
          }
        },
        {
          "action": "discord_post",
          "depends_on": ["create_package"],
          "channel": "announcements",
          "message": "🎉 Version ${build_release.version} Released!",
          "context": {
            "version": "${build_release.version}",
            "screenshots_path": "${capture_screenshots.screenshots_path}"
          }
        }
      ]
    },
    "discord-release-major": {
      "description": "Full Discord announcement for major releases",
      "steps": [
        {
          "id": "build_release",
          "action": "build",
          "targets": ["release"]
        },
        {
          "id": "create_changelog",
          "action": "generate_changelog",
          "since_version": "auto",
          "format": "discord",
          "sections": ["features", "improvements", "fixes"]
        },
        {
          "id": "capture_feature_screenshots",
          "action": "screenshot",
          "depends_on": ["build_release"],
          "scenes": ["new_features", "ui_showcase"],
          "resolution": "1920x1080",
          "output_dir": "discord_assets/",
          "format": "png"
        },
        {
          "id": "create_release_embed",
          "action": "discord_embed",
          "depends_on": ["create_changelog", "capture_feature_screenshots"],
          "title": "🎉 Version ${build_release.version} Released!",
          "description": "Major update with exciting new features",
          "color": "0x00ff00",
          "context": {
            "version": "${build_release.version}",
            "screenshots_path": "${capture_feature_screenshots.screenshots_path}"
          }
        },
        {
          "id": "announce_to_community",
          "action": "discord_post",
          "depends_on": ["create_release_embed"],
          "channel": "announcements",
          "message": "@everyone New major release is here!",
          "context": {
            "embeds": "${create_release_embed.embed_data}",
            "changelog_path": "${create_changelog.changelog_path}",
            "screenshots_path": "${capture_feature_screenshots.screenshots_path}"
          }
        },
        {
          "action": "discord_thread",
          "depends_on": ["announce_to_community"],
          "parent_channel": "announcements",
          "thread_name": "v${build_release.version} Discussion",
          "initial_message": "Share your thoughts on the new release!",
          "auto_archive": "24h"
        }
      ]
    },
    "site-update": {
      "description": "Update game website with latest content",
      "steps": [
        {
          "id": "build_demo",
          "action": "build",
          "targets": ["demo"]
        },
        {
          "id": "capture_screenshots",
          "action": "screenshot",
          "depends_on": ["build_demo"],
          "scenes": ["main_menu", "gameplay_sample", "boss_fight"],
          "resolution": "1920x1080",
          "output_dir": "site/assets/screenshots/",
          "format": "webp"
        },
        {
          "id": "extract_media",
          "action": "extract_assets",
          "depends_on": ["build_demo"],
          "types": ["trailer_clips", "soundtrack_samples"],
          "source_build": "demo",
          "output_dir": "site/assets/media/",
          "optimize": true
        },
        {
          "id": "generate_player_docs",
          "action": "generate_docs",
          "source_dirs": ["docs/player_guide", "docs/modding"],
          "output_format": "html",
          "template": "site_theme"
        },
        {
          "action": "deploy_site",
          "depends_on": ["capture_screenshots", "extract_media", "generate_player_docs"],
          "target_env": "staging",
          "build_assets": true,
          "context": {
            "screenshots_path": "${capture_screenshots.screenshots_path}",
            "docs_path": "${generate_player_docs.docs_path}"
          }
        }
      ]
    }
  },
  "targets": {
    "release": {
      "dir": "bin/release/",
      "entry": "src/entry/release/",
      "options": {
        "optimized": true,
        "debug_symbols": false
      },
      "flags": ["strip", "no-bounds-check"]
    },
    "demo": {
      "dir": "bin/demo/",
      "entry": "src/entry/demo/",
      "options": {
        "demo_mode": true,
        "analytics": false,
        "time_limit": "10m"
      },
      "flags": ["showcase", "no-save"]
    },
    "prototype": {
      "dir": "bin/proto/",
      "options": {
        "fast_compile": true,
        "skip_optimization": true,
        "experimental_features": true
      },
      "flags": ["prototype", "unsafe"]
    }
  }
}
```

### Implementation Roadmap

This design enables a build tool that becomes the central orchestrator for all development and release activities. Key implementation phases:

1. **Core Action System**: Implement the action definition schema with parameter validation and dependency resolution.

2. **Context Flow Engine**: Build the variable substitution and data passing system between steps.

3. **Target Configuration**: Implement the flexible target system with inheritance and overrides.

4. **Profile Execution**: Create the profile runner with dependency resolution and parallel execution.

5. **Domain-Specific Actions**: Implement actions for building, testing, packaging, documentation, and communication.

6. **Integration Points**: Connect with Discord APIs, deployment systems, and content management tools.

The result is a build system that transforms `./build -profile release-full` into a complete end-to-end release process, automating everything from compilation to community communication.

# Mon Aug 04 2025

- [ ] TODO: Write an application demo that can demo all things handled by the application/platform layer
- Exercise things like mouse position, drawing, input, etc
