
# Mon Jul 28 2025 - 1

ps aux
USER               PID  %CPU %MEM      VSZ    RSS   TT  STAT STARTED      TIME COMMAND
lily             28933 141.3  3.5 418034560 581600   ??  R     8:53PM   4:24.91 /Users/lily/Library/Application Support/Steam/steamapps/common/Hades II/Hade
lily             85572  98.8  0.0 410874832    112   ??  R    Sun04PM 566:33.83 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             85558  98.4  0.0 410857424    112   ??  R    Sun04PM 566:36.03 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83005  18.4  0.0 410857424    128   ??  R    Sun04PM  50:21.26 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81857  15.3  0.0 410857424    112   ??  R    Sun04PM  50:48.33 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             29151  12.7  0.1 426950928   8688   ??  R     8:56PM   0:00.05 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             29152  12.7  0.1 426950928   8672   ??  R     8:56PM   0:00.05 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             82307  11.7  0.0 410857424    112   ??  R    Sun04PM  50:41.01 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82397  11.3  0.0 410857424    112   ??  R    Sun04PM  50:37.52 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81917  10.9  0.0 410857424    112   ??  R    Sun04PM  50:48.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82822  10.3  0.0 410857424    112   ??  R    Sun04PM  50:23.81 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81845  10.2  0.0 410857424    112   ??  R    Sun04PM  50:45.64 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82733   9.9  0.0 410857424    112   ??  R    Sun04PM  50:32.17 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82868   9.9  0.0 410725328    112   ??  R    Sun04PM  50:24.59 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82990   9.7  0.0 410857424    112   ??  R    Sun04PM  50:19.21 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83118   9.6  0.0 410857424    112   ??  R    Sun04PM  50:21.84 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82295   9.6  0.0 410857424    128   ??  R    Sun04PM  50:40.30 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83190   9.4  0.0 410857424    112   ??  R    Sun04PM  50:17.77 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82512   9.3  0.0 410866640    112   ??  R    Sun04PM  50:30.02 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82472   9.1  0.0 410883024    128   ??  R    Sun04PM  50:36.79 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81809   9.1  0.0 410997712    128   ??  R    Sun04PM  50:56.12 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81953   8.8  0.0 410866640    112   ??  R    Sun04PM  50:45.19 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82361   8.6  0.0 410857424    112   ??  R    Sun04PM  50:39.79 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82484   8.6  0.0 411016144    112   ??  R    Sun04PM  50:32.79 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84971   8.4  0.0 410857424    112   ??  R    Sun04PM  49:20.34 /Users/lily/Documents/repos/eel-pool/bin/test/tests
root               121   8.4  0.3 427054752  51968   ??  Rs   13Jul25  58:40.37 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             82283   8.4  0.0 410857424     80   ??  R    Sun04PM  50:40.54 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82347   8.3  0.0 410997712    112   ??  R    Sun04PM  50:39.24 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81929   8.2  0.0 410857424    112   ??  R    Sun04PM  50:43.75 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82681   8.1  0.0 410857424    112   ??  R    Sun04PM  50:28.01 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82757   8.0  0.0 410857424    112   ??  R    Sun04PM  50:23.57 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81697   7.9  0.0 410725328    112   ??  R    Sun04PM  50:53.14 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81737   7.9  0.0 410988496    112   ??  R    Sun04PM  50:55.23 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81989   7.9  0.0 410725328    112   ??  R    Sun04PM  50:44.47 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83100   7.8  0.0 410988496    112   ??  R    Sun04PM  50:21.76 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83021   7.8  0.0 410857424    112   ??  R    Sun04PM  50:21.63 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82786   7.8  0.0 410865616    112   ??  R    Sun04PM  50:24.21 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82421   7.8  0.0 410857424    112   ??  R    Sun04PM  50:40.81 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82552   7.7  0.0 410725328    112   ??  R    Sun04PM  50:30.42 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83149   7.6  0.0 410856400    112   ??  R    Sun04PM  50:20.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82665   7.6  0.0 410857424    112   ??  R    Sun04PM  50:32.07 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81725   7.5  0.0 410857424    128   ??  R    Sun04PM  50:55.87 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84593   7.5  0.0 410857424    304   ??  R    Sun04PM  60:23.30 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82907   7.5  0.0 410857424    112   ??  R    Sun04PM  50:26.93 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84817   7.5  0.0 410857424    352   ??  R    Sun04PM  60:27.75 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84623   7.5  0.0 410857424    288   ??  R    Sun04PM  60:24.32 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81749   7.5  0.0 410997712    112   ??  R    Sun04PM  50:56.47 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84649   7.5  0.0 410857424    320   ??  R    Sun04PM  60:26.46 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84879   7.4  0.0 410857424    336   ??  R    Sun04PM  60:12.06 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82331   7.4  0.0 410857424    112   ??  R    Sun04PM  50:39.97 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84751   7.3  0.0 410857424    320   ??  R    Sun04PM  60:23.03 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84930   7.3  0.0 410857424    320   ??  R    Sun04PM  60:22.61 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84675   7.3  0.0 410857424    304   ??  R    Sun04PM  60:23.80 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84781   7.3  0.0 410857424    336   ??  R    Sun04PM  60:23.38 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             84704   7.3  0.0 410857424    320   ??  R    Sun04PM  60:15.71 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82568   7.3  0.0 410988496    112   ??  R    Sun04PM  50:27.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83725   7.3  0.0 410857424    112   ??  R    Sun04PM  49:34.60 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83742   7.2  0.0 410725328    112   ??  R    Sun04PM  49:28.87 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82957   6.4  0.0 410988496    112   ??  R    Sun04PM  50:18.03 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             29126   6.3  0.1 426958048   9104   ??  S     8:56PM   0:00.05 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             84567   6.2  0.0 410857424    336   ??  R    Sun04PM  60:22.00 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83539   6.1  0.0 410856400    112   ??  R    Sun04PM  49:34.08 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82810   6.0  0.0 410857424    112   ??  R    Sun04PM  50:22.27 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81869   6.0  0.0 410857424     80   ??  R    Sun04PM  50:43.92 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82524   5.8  0.0 410857424    112   ??  R    Sun04PM  50:34.69 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82385   5.8  0.0 410988496    112   ??  R    Sun04PM  50:39.47 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83697   5.7  0.0 410857424    112   ??  R    Sun04PM  49:27.47 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81881   5.7  0.0 410857424    112   ??  R    Sun04PM  50:45.74 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83064   5.7  0.0 410988496    112   ??  R    Sun04PM  50:20.32 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82319   5.6  0.0 410857424    112   ??  R    Sun04PM  50:39.70 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82652   5.6  0.0 410857424    112   ??  R    Sun04PM  50:27.59 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82798   5.6  0.0 410997712    112   ??  R    Sun04PM  50:28.38 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83076   5.5  0.0 410857424    112   ??  R    Sun04PM  50:17.81 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83734   5.5  0.0 410857424    112   ??  R    Sun04PM  49:33.64 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82770   5.5  0.0 410857424    112   ??  R    Sun04PM  50:28.42 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82053   5.5  0.0 410857424    112   ??  R    Sun04PM  50:39.73 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83556   5.5  0.0 410857424    112   ??  R    Sun04PM  49:35.82 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83717   5.4  0.0 410866640    112   ??  R    Sun04PM  49:30.79 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82709   5.3  0.0 410857424    128   ??  R    Sun04PM  50:29.59 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82931   5.3  0.0 411006928    112   ??  R    Sun04PM  50:23.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82269   5.2  0.0 411005904    112   ??  R    Sun04PM  50:42.17 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82433   5.1  0.0 410866640    112   ??  R    Sun04PM  50:39.75 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81833   5.1  0.0 410857424    112   ??  R    Sun04PM  50:51.65 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82854   5.1  0.0 410857424    112   ??  R    Sun04PM  50:20.06 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81773   5.0  0.0 410857424    112   ??  R    Sun04PM  50:56.95 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82593   5.0  0.0 410857424    112   ??  R    Sun04PM  50:38.02 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82919   4.8  0.0 410857424    128   ??  R    Sun04PM  50:20.65 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83588   4.8  0.0 410857424    112   ??  R    Sun04PM  49:32.86 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81941   4.8  0.0 410997712    112   ??  R    Sun04PM  50:46.65 /Users/lily/Documents/repos/eel-pool/bin/test/tests
_coreaudiod        187   4.8  0.1 427025232  22400   ??  Ss   13Jul25 520:05.53 /usr/sbin/coreaudiod
lily             82001   4.6  0.0 410857424    128   ??  R    Sun04PM  50:44.78 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82040   4.6  0.0 410857424    112   ??  R    Sun04PM  50:46.55 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81893   4.6  0.0 410857424    112   ??  R    Sun04PM  50:45.16 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81821   4.5  0.0 410857424    112   ??  R    Sun04PM  50:51.48 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83681   4.5  0.0 410874832    112   ??  R    Sun04PM  49:27.82 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83088   4.3  0.0 410857424    112   ??  R    Sun04PM  50:25.34 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81761   4.3  0.0 410857424    112   ??  R    Sun04PM  50:54.36 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83136   4.3  0.0 410997712    112   ??  R    Sun04PM  50:17.98 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81965   4.2  0.0 410857424    112   ??  R    Sun04PM  50:49.85 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81977   4.1  0.0 410857424    112   ??  R    Sun04PM  50:42.24 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             29125   4.1  0.1 426958048   9120   ??  S     8:56PM   0:00.05 /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framew
lily             83576   4.1  0.0 410857424    128   ??  R    Sun04PM  49:28.87 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82943   4.1  0.0 410857424    112   ??  R    Sun04PM  50:19.93 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83034   4.1  0.0 410857424    128   ??  R    Sun04PM  50:25.25 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82014   4.0  0.0 410865616    112   ??  R    Sun04PM  50:43.32 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82745   4.0  0.0 410857424    112   ??  R    Sun04PM  50:29.95 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82622   3.9  0.0 410866640    112   ??  R    Sun04PM  50:33.21 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83689   3.9  0.0 410997712    112   ??  R    Sun04PM  49:30.99 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83564   3.9  0.0 410857424    112   ??  R    Sun04PM  49:30.80 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82887   3.9  0.0 410857424    112   ??  R    Sun04PM  50:24.67 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82637   3.9  0.0 410857424    112   ??  R    Sun04PM  50:33.44 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82580   3.9  0.0 410857424    128   ??  R    Sun04PM  50:30.28 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82028   3.9  0.0 410857424    112   ??  R    Sun04PM  50:43.77 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81797   3.9  0.0 410988496    128   ??  R    Sun04PM  50:56.75 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81713   3.9  0.0 410988496    112   ??  R    Sun04PM  50:54.81 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82452   3.7  0.0 410857424     80   ??  R    Sun04PM  50:35.13 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82970   3.7  0.0 410857424    112   ??  R    Sun04PM  50:23.12 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82409   3.7  0.0 410725328    112   ??  R    Sun04PM  50:37.55 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82500   3.7  0.0 410997712    128   ??  R    Sun04PM  50:34.97 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83166   3.6  0.0 410857424    112   ??  R    Sun04PM  50:19.25 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82373   3.6  0.0 410857424    128   ??  R    Sun04PM  50:41.98 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81905   3.6  0.0 410857424    128   ??  R    Sun04PM  50:42.95 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82834   3.6  0.0 410725328    112   ??  R    Sun04PM  50:23.41 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83050   3.5  0.0 410857424    112   ??  R    Sun04PM  50:20.77 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             83178   3.4  0.0 410857424    112   ??  R    Sun04PM  50:19.15 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             81785   3.4  0.0 411006928    112   ??  R    Sun04PM  50:57.35 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82697   3.4  0.0 410997712    112   ??  R    Sun04PM  50:24.77 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82609   3.3  0.0 410857424    112   ??  R    Sun04PM  50:30.21 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82721   3.2  0.0 410725328    112   ??  R    Sun04PM  50:24.89 /Users/lily/Documents/repos/eel-pool/bin/test/tests
lily             82536   3.2  0.0 410857424    112   ??  R    Sun04PM  50:32.95 /Users/lily/Documents/repos/eel-pool/bin/test/tests
...
lily             85567   0.0  0.0 412883888     16   ??  S    Sun04PM   0:01.10 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             85552   0.0  0.0 412899312     16   ??  S    Sun04PM   0:01.05 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84933   0.0  0.0 412886176     16   ??  S    Sun04PM   0:01.05 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84882   0.0  0.0 412902624     16   ??  S    Sun04PM   0:01.28 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84820   0.0  0.0 412885120     16   ??  S    Sun04PM   0:01.22 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84785   0.0  0.0 412919040     16   ??  S    Sun04PM   0:01.13 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84754   0.0  0.0 412894400     16   ??  S    Sun04PM   0:01.26 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84725   0.0  0.0 412911872     16   ??  S    Sun04PM   0:01.21 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84681   0.0  0.0 412901600     16   ??  S    Sun04PM   0:01.21 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84652   0.0  0.0 412893376     16   ??  S    Sun04PM   0:01.20 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84626   0.0  0.0 412895392     16   ??  S    Sun04PM   0:01.10 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84599   0.0  0.0 412919040     16   ??  S    Sun04PM   0:01.12 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84570   0.0  0.0 412901600     16   ??  S    Sun04PM   0:01.15 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors
lily             84544   0.0  0.0 412900544     16   ??  S    Sun04PM   0:01.13 odin test src/tests -out:bin/test/tests -debug -warnings-as-errors

## Explanation

I accidentally ran a bunch of tests that failed to close all of their processes.

Part of the testing process needs to be a fail safe cleanup process that
identifies any processes "left behind" and records them to mark as failures.
Threads that did not respond to the stop signal.

TODO: Identify all processes that are started by a process and record them in a durable manner.
Check that all threads exit when they are told to.

TODO: Improve test process with a checker for leaked processes.
Or maybe put all executed processes into a registry?

# Tue Jul 29 2025 - 1

Today the game thread hung before completing a single iteration. Just a total deadlock.
And that's exactly what it was. A Mutex deadlock. I'm familiar with the tenants of Mutexes:

- lock when performing a write

- no lock required when reading

- minimize surface area of the lock interactions

But, this was a failure case I had not seen before and thus did not know to look for.
A function took a lock and then called a function that took another lock.
Duh. Of course that would never work. The second lock will wait forever because
it's waiting on an unlock that is guaranteed to occur after it.
This must be an extremely classic failure case that occurs when an API doesn't
keep track of it's current lock state/share the lock across a call chain.
But somehow I didn't know it before today. Maybe I'd heard it before, but it
definitely didn't stick.

> TIL:
> Don't call a function that locks the same mutex that is locked within the
> current scope. In other words, mutex lock/unlock scopes don't nest by default.
> without shared checks, the program doesn't know it's entering a deadlocked
> state even though it's guaranteed. Could this be fixed with a lil bit o
> metaprogramming. Could fix this with a "local" global variable.

TODO: Start a timer for a single successful iteration of a thread loop. If it
does not complete the first iteration within some time period, then mark the
thread job as a failure and kill the thread. This will be a crucial tool in
validating thread behavior for testing.

# Wed Jul 30 2025 - 1

## Advanced Build System Design - Profile-Based Workflow Orchestration

This design session explored a powerful build configuration system that goes far
beyond traditional compilation - it orchestrates entire development and release
workflows through composable "profiles."

### Core Concepts

**Profiles as Workflow Orchestrators**: Rather than just building code, profiles
define complete end-to-end processes - from building and testing to generating
marketing materials, updating websites, and communicating with communities.

**Action-Step Architecture**: Each profile consists of structured steps that
invoke well-defined actions. Actions have explicit parameter schemas,
dependencies, and data flow contracts.

**Context Flow Between Steps**: Steps can consume outputs from previous steps
through a variable substitution system (`${step_id.output_var}`), enabling
complex data pipelines.

**Declarative Dependencies**: Explicit `depends_on` relationships ensure proper
execution order while enabling parallelization where possible.

### Patterns and Creative Use Cases

**Release Pipeline Orchestration**: Complete release workflows that build, test,
package, generate changelogs, capture screenshots, deploy websites, and notify
communities - all in a single profile execution.

**Content Marketing Automation**: Profiles that build demo versions, capture
promotional screenshots, extract trailer footage, and prepare press kits for
marketing campaigns.

**Community Communication Workflows**: Rich Discord integration for everything
from major release announcements with embeds and threads to urgent hotfix
notifications and scheduled development updates.

**Environment-Specific Configurations**: Different build targets (release,
develop, demo, prototype) with their own optimization settings, feature flags,
and asset bundles.

### Schema Evolution

The design evolved through three key refinements:

1. **Structured Action Parameters**: Moving from simple action strings to rich parameter schemas with validation and IDE support.

2. **Step Dependencies and Context Flow**: Adding explicit dependencies and data passing between steps to enable complex workflows.

3. **Discord-Specific Actions**: Specialized actions for community engagement, demonstrating how the system can extend into any domain.

### Final Schema Design

```json
{
  "action_definitions": {
    "build": {
      "params": ["targets", "watch", "incremental"],
      "required": ["targets"],
      "provides": ["build_path", "version", "artifacts"]
    },
    "screenshot": {
      "params": ["scenes", "resolution", "output_dir", "format"],
      "required": ["scenes"],
      "depends_on": ["build"],
      "provides": ["screenshots_path", "screenshot_count"]
    },
    "discord_post": {
      "params": ["channel", "message", "embeds", "files", "thread_name"],
      "required": ["channel", "message"],
      "context_vars": ["version", "changelog_path", "screenshots_path"],
      "provides": ["message_id", "message_url"]
    },
    "package": {
      "params": ["format", "include_docs", "branding", "compression"],
      "required": ["format"],
      "context_vars": ["build_path", "changelog_path", "screenshots_path"],
      "provides": ["package_path", "package_size"]
    }
  },
  "profiles": {
    "release-full": {
      "description": "Complete release pipeline: build, validate, package",
      "steps": [
        {
          "id": "build_release",
          "action": "build",
          "targets": ["release"]
        },
        {
          "id": "capture_screenshots",
          "action": "screenshot",
          "depends_on": ["build_release"],
          "scenes": ["main_menu", "gameplay"],
          "resolution": "1920x1080",
          "output_dir": "release_assets/"
        },
        {
          "id": "create_package",
          "action": "package",
          "depends_on": ["build_release", "capture_screenshots"],
          "format": "zip",
          "context": {
            "build_path": "${build_release.build_path}",
            "screenshots_path": "${capture_screenshots.screenshots_path}"
          }
        },
        {
          "action": "discord_post",
          "depends_on": ["create_package"],
          "channel": "announcements",
          "message": "🎉 Version ${build_release.version} Released!",
          "context": {
            "version": "${build_release.version}",
            "screenshots_path": "${capture_screenshots.screenshots_path}"
          }
        }
      ]
    },
    "discord-release-major": {
      "description": "Full Discord announcement for major releases",
      "steps": [
        {
          "id": "build_release",
          "action": "build",
          "targets": ["release"]
        },
        {
          "id": "create_changelog",
          "action": "generate_changelog",
          "since_version": "auto",
          "format": "discord",
          "sections": ["features", "improvements", "fixes"]
        },
        {
          "id": "capture_feature_screenshots",
          "action": "screenshot",
          "depends_on": ["build_release"],
          "scenes": ["new_features", "ui_showcase"],
          "resolution": "1920x1080",
          "output_dir": "discord_assets/",
          "format": "png"
        },
        {
          "id": "create_release_embed",
          "action": "discord_embed",
          "depends_on": ["create_changelog", "capture_feature_screenshots"],
          "title": "🎉 Version ${build_release.version} Released!",
          "description": "Major update with exciting new features",
          "color": "0x00ff00",
          "context": {
            "version": "${build_release.version}",
            "screenshots_path": "${capture_feature_screenshots.screenshots_path}"
          }
        },
        {
          "id": "announce_to_community",
          "action": "discord_post",
          "depends_on": ["create_release_embed"],
          "channel": "announcements",
          "message": "@everyone New major release is here!",
          "context": {
            "embeds": "${create_release_embed.embed_data}",
            "changelog_path": "${create_changelog.changelog_path}",
            "screenshots_path": "${capture_feature_screenshots.screenshots_path}"
          }
        },
        {
          "action": "discord_thread",
          "depends_on": ["announce_to_community"],
          "parent_channel": "announcements",
          "thread_name": "v${build_release.version} Discussion",
          "initial_message": "Share your thoughts on the new release!",
          "auto_archive": "24h"
        }
      ]
    },
    "site-update": {
      "description": "Update game website with latest content",
      "steps": [
        {
          "id": "build_demo",
          "action": "build",
          "targets": ["demo"]
        },
        {
          "id": "capture_screenshots",
          "action": "screenshot",
          "depends_on": ["build_demo"],
          "scenes": ["main_menu", "gameplay_sample", "boss_fight"],
          "resolution": "1920x1080",
          "output_dir": "site/assets/screenshots/",
          "format": "webp"
        },
        {
          "id": "extract_media",
          "action": "extract_assets",
          "depends_on": ["build_demo"],
          "types": ["trailer_clips", "soundtrack_samples"],
          "source_build": "demo",
          "output_dir": "site/assets/media/",
          "optimize": true
        },
        {
          "id": "generate_player_docs",
          "action": "generate_docs",
          "source_dirs": ["docs/player_guide", "docs/modding"],
          "output_format": "html",
          "template": "site_theme"
        },
        {
          "action": "deploy_site",
          "depends_on": ["capture_screenshots", "extract_media", "generate_player_docs"],
          "target_env": "staging",
          "build_assets": true,
          "context": {
            "screenshots_path": "${capture_screenshots.screenshots_path}",
            "docs_path": "${generate_player_docs.docs_path}"
          }
        }
      ]
    }
  },
  "targets": {
    "release": {
      "dir": "bin/release/",
      "entry": "src/entry/release/",
      "options": {
        "optimized": true,
        "debug_symbols": false
      },
      "flags": ["strip", "no-bounds-check"]
    },
    "demo": {
      "dir": "bin/demo/",
      "entry": "src/entry/demo/",
      "options": {
        "demo_mode": true,
        "analytics": false,
        "time_limit": "10m"
      },
      "flags": ["showcase", "no-save"]
    },
    "prototype": {
      "dir": "bin/proto/",
      "options": {
        "fast_compile": true,
        "skip_optimization": true,
        "experimental_features": true
      },
      "flags": ["prototype", "unsafe"]
    }
  }
}
```

### Implementation Roadmap

This design enables a build tool that becomes the central orchestrator for all development and release activities. Key implementation phases:

1. **Core Action System**: Implement the action definition schema with parameter validation and dependency resolution.

2. **Context Flow Engine**: Build the variable substitution and data passing system between steps.

3. **Target Configuration**: Implement the flexible target system with inheritance and overrides.

4. **Profile Execution**: Create the profile runner with dependency resolution and parallel execution.

5. **Domain-Specific Actions**: Implement actions for building, testing, packaging, documentation, and communication.

6. **Integration Points**: Connect with Discord APIs, deployment systems, and content management tools.

The result is a build system that transforms `./build -profile release-full` into a complete end-to-end release process, automating everything from compilation to community communication.

# Mon Aug 04 2025 - 1

- [ ] TODO: Write an application demo that can demo all things handled by the application/platform layer
- Exercise things like mouse position, drawing, input, etc

# Tue Aug 05 2025 - 1

## Understanding Unordered Sets: A Simple Implementation Guide

An **unordered set** is a fundamental data structure that stores unique elements without maintaining any particular order. It's particularly useful when you need fast lookups and don't care about the sequence of elements.

### Core Concepts

#### What Makes a Set "Unordered"?
Unlike arrays or lists where elements have positions (index 0, 1, 2...), unordered sets organize data based on **hash values** rather than insertion order. This trade-off between order and speed makes them ideal for membership testing.

#### Key Properties
1. **No duplicates** - Each element can appear only once
2. **Dynamic sizing** - Grows and shrinks based on content
3. **Fast lookups** - O(1) average time complexity for checking if an element exists
4. **No guaranteed order** - Elements may appear in any sequence when iterated

### The Hash-Based Approach

The magic of unordered sets lies in **hashing**. When you insert an element:

1. The element is passed through a hash function
2. The hash function produces a number (the hash value)
3. This number determines where to store the element internally
4. Later lookups use the same hash to quickly find the element

Think of it like a library with books sorted by a special numbering system - instead of searching shelf by shelf, you calculate exactly where a book should be.

### Simple Implementation Structure

Looking at the provided Odin code, we see the foundation:

```odin
UnorderedSet :: struct($keyT: typeid, $valT: typeid) {
    items: map[keyT]valT,
}
```

This implementation cleverly uses Odin's built-in `map` as the underlying storage. Maps naturally provide:
- Hash-based lookup
- Duplicate prevention (keys must be unique)
- Dynamic resizing

### Why This Matters

In the Game of Life example from the notes, traditional approaches store *every* cell in a grid, even empty ones. With a sparse approach using unordered sets:

- **Memory efficiency**: Only store active cells
- **Computational efficiency**: Only process cells that might change
- **Scalability**: Handle virtually infinite game boards

Instead of checking 1 million empty cells, you might only check 1,000 active ones - a 1000x improvement!

### Learning Takeaways

The unordered set demonstrates several important computer science principles:
- **Space-time tradeoffs**: Use more sophisticated data structures for better performance
- **Sparse data representation**: Don't store what you don't need
- **Hash table fundamentals**: Fast lookups through clever organization
- **Generic programming**: One implementation works for many data types

This simple yet powerful abstraction transforms problems from "check everything" to "check only what matters" - a fundamental optimization strategy in computer science.

# Fri Aug 15 2025

## Job System Design Notes

### Core API Components

**Job Definition:**
```odin
Job :: struct {
    func: proc(data: rawptr),
    data: rawptr,
    priority: Job_Priority,
}

Job_Priority :: enum {
    LOW, NORMAL, HIGH, CRITICAL
}
```

**Job Submission:**
```odin
submit_job :: proc(job: Job) -> Job_Handle
submit_jobs :: proc(jobs: []Job) -> []Job_Handle
submit_job_with_dependency :: proc(job: Job, dependency: Job_Handle) -> Job_Handle
```

**Job Control:**
```odin
Job_Handle :: distinct u64

wait_for_job :: proc(handle: Job_Handle)
wait_for_jobs :: proc(handles: []Job_Handle)
is_job_complete :: proc(handle: Job_Handle) -> bool
cancel_job :: proc(handle: Job_Handle) -> bool
```

**Worker Management:**
```odin
Job_System_Config :: struct {
    worker_count: int,
    queue_size: int,
    enable_work_stealing: bool,
}

init_job_system :: proc(config: Job_System_Config)
shutdown_job_system :: proc()
get_worker_count :: proc() -> int
```

**Advanced Features:**
```odin
// Job groups for batch operations
Job_Group :: distinct u64
create_job_group :: proc() -> Job_Group
submit_job_to_group :: proc(job: Job, group: Job_Group) -> Job_Handle
wait_for_group :: proc(group: Job_Group)

// Fiber/coroutine support for job yielding
yield_job :: proc() // Allow other jobs to run
resume_job :: proc(handle: Job_Handle)
```

### Odin Thread Pool Integration

**Core Types:**
```odin
Pool :: struct { ... }
Task :: struct { ... }
Task_Proc :: proc(task: Task)
```

**Pool Management:**
```odin
pool_init :: proc(pool: ^Pool, allocator: Allocator, thread_count: int)
pool_start :: proc(pool: ^Pool)
pool_join :: proc(pool: ^Pool)
pool_shutdown :: proc(pool: ^Pool)
pool_destroy :: proc(pool: ^Pool)
```

**Task Operations:**
```odin
pool_add_task :: proc(pool: ^Pool, allocator: Allocator, procedure: Task_Proc, data: rawptr)
pool_num_waiting :: proc(pool: ^Pool) -> int
pool_num_in_processing :: proc(pool: ^Pool) -> int
pool_stop_task :: proc(pool: ^Pool, task: ^Task)
```

**Usage Pattern:**
```odin
pool: thread.Pool
thread.pool_init(&pool, context.allocator, 4)
thread.pool_start(&pool)

// Add work
thread.pool_add_task(&pool, context.allocator, my_task_proc, &my_data)

// Wait for completion
thread.pool_join(&pool)
thread.pool_destroy(&pool)
```

### Game Job System Wrapper

**Job System Structure:**
```odin
Job_System :: struct {
    pool: thread.Pool,
    allocator: mem.Allocator,
    job_counter: atomic.U64,
    completed_jobs: map[Job_Handle]bool,
    mutex: sync.Mutex,
}

Job_Handle :: distinct u64
Job_Proc :: proc(data: rawptr)

Job_Priority :: enum {
    LOW, NORMAL, HIGH, CRITICAL
}
```

**Core API:**
```odin
// System lifecycle
job_system_init :: proc(js: ^Job_System, allocator: mem.Allocator, thread_count := 0)
job_system_start :: proc(js: ^Job_System)
job_system_shutdown :: proc(js: ^Job_System)
job_system_destroy :: proc(js: ^Job_System)

// Job submission
submit_job :: proc(js: ^Job_System, procedure: Job_Proc, data: rawptr, priority := Job_Priority.NORMAL) -> Job_Handle
submit_jobs :: proc(js: ^Job_System, jobs: []Job_Data) -> []Job_Handle

Job_Data :: struct {
    procedure: Job_Proc,
    data: rawptr,
    priority: Job_Priority,
}
```

**Synchronization:**
```odin
wait_for_job :: proc(js: ^Job_System, handle: Job_Handle)
wait_for_jobs :: proc(js: ^Job_System, handles: []Job_Handle)
is_job_complete :: proc(js: ^Job_System, handle: Job_Handle) -> bool
```

**Status Queries:**
```odin
get_pending_job_count :: proc(js: ^Job_System) -> int
get_active_job_count :: proc(js: ^Job_System) -> int
get_worker_count :: proc(js: ^Job_System) -> int
```

**Game-Specific Extensions:**
```odin
// Frame-based processing
Job_Group :: distinct u64

create_job_group :: proc(js: ^Job_System) -> Job_Group
submit_job_to_group :: proc(js: ^Job_System, group: Job_Group, procedure: Job_Proc, data: rawptr) -> Job_Handle
wait_for_group :: proc(js: ^Job_System, group: Job_Group)

// Common game patterns
submit_parallel_for :: proc(js: ^Job_System, start, end: int, procedure: proc(index: int, data: rawptr), data: rawptr) -> Job_Group
```

### Implementation Details

**System Lifecycle:**
```odin
job_system_init :: proc(js: ^Job_System, allocator: mem.Allocator, thread_count := 0) {
    // Determine optimal thread count
    actual_thread_count := thread_count
    if actual_thread_count <= 0 {
        actual_thread_count = max(1, runtime.processor_core_count() - 1) // Leave one core for main thread
    }

    // Initialize the job system
    js.allocator = allocator
    js.job_counter = 0
    js.completed_jobs = make(map[Job_Handle]bool, allocator)
    sync.mutex_init(&js.mutex)

    // Initialize the underlying thread pool
    thread.pool_init(&js.pool, allocator, actual_thread_count)
}

job_system_start :: proc(js: ^Job_System) {
    // Start the thread pool workers
    thread.pool_start(&js.pool)
}

job_system_shutdown :: proc(js: ^Job_System) {
    // Wait for all current jobs to complete
    thread.pool_join(&js.pool)

    // Stop all worker threads
    thread.pool_shutdown(&js.pool)

    // Clear completed jobs tracking
    sync.mutex_lock(&js.mutex)
    clear(&js.completed_jobs)
    sync.mutex_unlock(&js.mutex)
}

job_system_destroy :: proc(js: ^Job_System) {
    // Ensure system is shut down first
    job_system_shutdown(js)

    // Destroy the thread pool
    thread.pool_destroy(&js.pool)

    // Clean up resources
    delete(js.completed_jobs)
    sync.mutex_destroy(&js.mutex)

    // Zero out the struct
    js^ = {}
}
```

**Synchronization Procedures:**
```odin
wait_for_job :: proc(js: ^Job_System, handle: Job_Handle) {
    // Busy wait with yield for job completion
    for !is_job_complete(js, handle) {
        runtime.yield()  // Yield to other threads
    }
}

wait_for_jobs :: proc(js: ^Job_System, handles: []Job_Handle) {
    // Wait for all jobs to complete
    for handle in handles {
        wait_for_job(js, handle)
    }

    // Alternative optimized approach:
    // for {
    //     all_complete := true
    //     for handle in handles {
    //         if !is_job_complete(js, handle) {
    //             all_complete = false
    //             break
    //         }
    //     }
    //     if all_complete do break
    //     runtime.yield()
    // }
}

is_job_complete :: proc(js: ^Job_System, handle: Job_Handle) -> bool {
    sync.mutex_lock(&js.mutex)
    defer sync.mutex_unlock(&js.mutex)

    completed, exists := js.completed_jobs[handle]
    return exists && completed
}
```

**Status Query Procedures:**
```odin
get_pending_job_count :: proc(js: ^Job_System) -> int {
    return thread.pool_num_waiting(&js.pool)
}

get_active_job_count :: proc(js: ^Job_System) -> int {
    return thread.pool_num_in_processing(&js.pool)
}

get_worker_count :: proc(js: ^Job_System) -> int {
    // Access pool's internal thread count
    // Note: May need to store this in Job_System if pool doesn't expose it
    return js.pool.thread_count  // Assuming this field exists
}
```

**Job Completion Tracking:**
```odin
_internal_task_wrapper :: proc(task: thread.Task) {
    // Extract job data
    job_data := cast(^_Job_Wrapper_Data)task.data

    // Execute the actual job
    job_data.procedure(job_data.user_data)

    // Mark as completed
    sync.mutex_lock(&job_data.job_system.mutex)
    job_data.job_system.completed_jobs[job_data.handle] = true
    sync.mutex_unlock(&job_data.job_system.mutex)

    // Clean up wrapper data
    free(job_data, job_data.job_system.allocator)
}

_Job_Wrapper_Data :: struct {
    handle: Job_Handle,
    job_system: ^Job_System,
    procedure: Job_Proc,
    user_data: rawptr,
}
```

### Event Emission

**Event Types:**
```odin
Job_Event_Type :: enum {
    JOB_STARTED,
    JOB_COMPLETED,
    JOB_FAILED,
    JOB_CANCELLED,
    WORKER_IDLE,
    WORKER_BUSY,
    SYSTEM_SHUTDOWN,
}

Job_Event :: struct {
    type: Job_Event_Type,
    timestamp: time.Time,
    job_handle: Job_Handle,
    worker_id: int,
    error_message: string, // For JOB_FAILED events
}

Event_Config :: struct {
    max_events: int,
    allocator: mem.Allocator,
}
```

**Event Configuration:**
```odin
// Enable event emission for the job system
job_system_enable_events :: proc(js: ^Job_System, config: Event_Config) {
    js.event_queue = make([dynamic]Job_Event, 0, config.max_events, config.allocator)
    js.event_allocator = config.allocator
    js.events_enabled = true
    sync.mutex_init(&js.event_mutex)
}

// Disable event emission
job_system_disable_events :: proc(js: ^Job_System) {
    sync.mutex_lock(&js.event_mutex)
    defer sync.mutex_unlock(&js.event_mutex)

    delete(js.event_queue)
    js.events_enabled = false
    sync.mutex_destroy(&js.event_mutex)
}
```

**Event Production:**
```odin
// Internal procedure to emit events
_emit_event :: proc(js: ^Job_System, event_type: Job_Event_Type, handle: Job_Handle = 0, worker_id := -1, error_msg := "") {
    if !js.events_enabled do return

    sync.mutex_lock(&js.event_mutex)
    defer sync.mutex_unlock(&js.event_mutex)

    // Create event
    event := Job_Event{
        type = event_type,
        timestamp = time.now(),
        job_handle = handle,
        worker_id = worker_id,
        error_message = strings.clone(error_msg, js.event_allocator) if error_msg != "" else "",
    }

    // Add to queue (with overflow protection)
    if len(js.event_queue) < cap(js.event_queue) {
        append(&js.event_queue, event)
    } else {
        // Optional: Drop oldest event or log overflow
        ordered_remove(&js.event_queue, 0) // Remove oldest
        append(&js.event_queue, event)
    }
}
```

**Event Consumption:**
```odin
// Poll for events (non-blocking)
poll_job_events :: proc(js: ^Job_System, out_events: ^[dynamic]Job_Event) -> int {
    if !js.events_enabled do return 0

    sync.mutex_lock(&js.event_mutex)
    defer sync.mutex_unlock(&js.event_mutex)

    event_count := len(js.event_queue)
    if event_count == 0 do return 0

    // Copy events to output buffer
    append(out_events, ..js.event_queue[:])

    // Clear the internal queue
    clear(&js.event_queue)

    return event_count
}

// Get event count without consuming
get_pending_event_count :: proc(js: ^Job_System) -> int {
    if !js.events_enabled do return 0

    sync.mutex_lock(&js.event_mutex)
    defer sync.mutex_unlock(&js.event_mutex)

    return len(js.event_queue)
}

// Peek at next event without consuming
peek_next_event :: proc(js: ^Job_System) -> (Job_Event, bool) {
    if !js.events_enabled do return {}, false

    sync.mutex_lock(&js.event_mutex)
    defer sync.mutex_unlock(&js.event_mutex)

    if len(js.event_queue) == 0 do return {}, false

    return js.event_queue[0], true
}
```

**Updated Job_System Structure:**
```odin
Job_System :: struct {
    // ... existing fields ...

    // Event system fields
    events_enabled: bool,
    event_queue: [dynamic]Job_Event,
    event_allocator: mem.Allocator,
    event_mutex: sync.Mutex,
}
```

**Usage Pattern:**
```odin
// Setup
job_system_enable_events(&job_system, {max_events = 1000, allocator = context.allocator})

// In game loop or separate thread
events: [dynamic]Job_Event
defer delete(events)

event_count := poll_job_events(&job_system, &events)
for event in events {
    switch event.type {
    case .JOB_COMPLETED:
        log.info("Job completed:", event.job_handle)
    case .JOB_FAILED:
        log.error("Job failed:", event.error_message)
    }
}
```

### Design Principles

- **Thread safety**: Mutex protects shared state like completed jobs map
- **Resource management**: Proper cleanup order in destroy
- **Graceful shutdown**: `pool_join()` ensures jobs complete before shutdown
- **Memory management**: Wrapper data cleanup after job completion
- **Asynchronous events**: Thread-safe queuing allows external monitoring without blocking job execution

This design provides thread-safe job scheduling, dependency management, and efficient work distribution across available cores while building on Odin's existing thread pool infrastructure.

# Thu Aug 21 2025

Begin here tomorrow.

```
❯ mise diagnostic -- -debug
[bootstrap] sources up-to-date, skipping
[diagnostic] $ $MISE_PROJECT_ROOT/build -dev -verbose -run -run-arg:-run-for:10 -debug
[INFO ] --- [2025-08-22 06:23:35] [225:dev()] Building a development build
[DEBUG] --- [2025-08-22 06:23:35] [128:run_proc()] Running process: mkdir -p bin/develop
[DEBUG] --- [2025-08-22 06:23:35] [128:run_proc()] Running process: odin build src/entry/game -out:bin/develop/game -debug -define:FRAME_DEBUG=true
[INFO ] --- [2025-08-22 06:23:36] [238:dev()] Running development build
[DEBUG] --- [2025-08-22 06:23:36] [128:run_proc()] Running process: bin/develop/game -run-for:10
[DEBUG] --- [2025-08-22 06:23:36] [130:run_proc()] With environment:
[DEBUG] --- [2025-08-22 06:23:36] [131:run_proc()]   RUST_BACKTRACE=full
[INFO ] --- [2025-08-22 06:23:36] [app.odin:46:app_init()] [18837220] Initializing Application...
[INFO ] --- [2025-08-22 06:23:36] [sdl.odin:52:sdl_init()] [18837220] Initializing SDL...
[INFO ] --- [2025-08-22 06:23:36] [sdl.odin:53:sdl_init()] [18837220] SDL initialized
[INFO ] --- [2025-08-22 06:23:36] [wgpu.odin:35:wgpu_init()] [18837220] Initializing WebGPU...
[DEBUG] --- [2025-08-22 06:23:36] [wgpu.odin:164:wgpu_resize()] [18837220] WebGPU: resizing surface to (1280x720)
[INFO ] --- [2025-08-22 06:23:36] [wgpu.odin:36:wgpu_init()] [18837220] WebGPU initialized
[INFO ] --- [2025-08-22 06:23:36] [render.odin:56:render_init()] [18837220] Initializing Render...
[INFO ] --- [2025-08-22 06:23:36] [render.odin:135:sprite_batcher_init()] [18837220] Initializing Sprite Batcher...
[INFO ] --- [2025-08-22 06:23:36] [render.odin:136:sprite_batcher_init()] [18837220] Sprite Batcher initialized.
[INFO ] --- [2025-08-22 06:23:36] [render.odin:57:render_init()] [18837220] Render initialized.
[DEBUG] --- [2025-08-22 06:23:36] [game.odin:19:game_init()] [18837220] Begin initializing game module
[DEBUG] --- [2025-08-22 06:23:36] [game.odin:20:game_init()] [18837220] End initializing game module
[INFO ] --- [2025-08-22 06:23:36] [app.odin:47:app_init()] [18837220] Application initialized
[INFO ] --- [2025-08-22 06:23:36] [app.odin:89:app_run()] [18837220] Running App for 10 frames then exiting.
[DEBUG] --- [2025-08-22 06:23:36] [wgpu.odin:164:wgpu_resize()] [18837220] WebGPU: resizing surface to (1280x720)
[DEBUG] --- [2025-08-22 06:23:36] [game.odin:38:game_update()] [18837220] Begin updating game state
[DEBUG] --- [2025-08-22 06:23:36] [game.odin:39:game_update()] [18837220] End updating game state
[DEBUG] --- [2025-08-22 06:23:36] [render.odin:77:renderpass_begin()] [18837220] Beginning render pass...
[DEBUG] --- [2025-08-22 06:23:36] [game.odin:46:game_draw()] [18837220] Begin drawing game frame
[DEBUG] --- [2025-08-22 06:23:36] [game.odin:47:game_draw()] [18837220] End drawing game frame
[DEBUG] --- [2025-08-22 06:23:36] [render.odin:107:renderpass_end()] [18837220] Ending render pass...
[DEBUG] --- [2025-08-22 06:23:36] [render.odin:299:sprite_batcher_draw()] [18837220] Begin Sprite Batcher Draw...
[DEBUG] --- [2025-08-22 06:23:36] [render.odin:300:sprite_batcher_draw()] [18837220] End Sprite Batcher Draw.

thread '<unnamed>' panicked at src/lib.rs:417:5:
wgpu uncaptured error:
Validation Error

Caused by:
  In wgpuRenderPassEncoderEnd
    In a pass parameter
      No color attachments or depth attachments were provided, at least one attachment of any kind must be provided


stack backtrace:
   0:        0x100d60bf8 - std::backtrace_rs::backtrace::libunwind::trace::hd09570c029a6744a
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/../../backtrace/src/backtrace/libunwind.rs:117:9
   1:        0x100d60bf8 - std::backtrace_rs::backtrace::trace_unsynchronized::h8d2fa64833f91cb3
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/../../backtrace/src/backtrace/mod.rs:66:14
   2:        0x100d60bf8 - std::sys::backtrace::_print_fmt::h567d2a106a3b0dee
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/sys/backtrace.rs:66:9
   3:        0x100d60bf8 - <std::sys::backtrace::BacktraceLock::print::DisplayBacktrace as core::fmt::Display>::fmt::h92dda645f072dcaf
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/sys/backtrace.rs:39:26
   4:        0x100da0c90 - core::fmt::rt::Argument::fmt::hc0b28dad2d7b7ba8
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/fmt/rt.rs:184:76
   5:        0x100da0c90 - core::fmt::write::hbc92919d8e8f9a96
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/fmt/mod.rs:1481:21
   6:        0x100d56c28 - std::io::default_write_fmt::h0768ab719ca8b5cc
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/io/mod.rs:639:11
   7:        0x100d56c28 - std::io::Write::write_fmt::hcee3b5dc9ab531be
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/io/mod.rs:1914:13
   8:        0x100d60aac - std::sys::backtrace::BacktraceLock::print::h0f497abce563e5d2
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/sys/backtrace.rs:42:9
   9:        0x100d62dc8 - std::panicking::default_hook::{{closure}}::h62595143a6c21f05
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:300:22
  10:        0x100d62c18 - std::panicking::default_hook::hd800536ed1df5085
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:327:9
  11:        0x100d63940 - std::panicking::rust_panic_with_hook::h1882a30575fbb763
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:833:13
  12:        0x100d6356c - std::panicking::begin_panic_handler::{{closure}}::h39275ef3005e6337
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:706:13
  13:        0x100d610a8 - std::sys::backtrace::__rust_end_short_backtrace::h6ede323c05a76849
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/sys/backtrace.rs:168:18
  14:        0x100d63214 - __rustc[95feac21a9532783]::rust_begin_unwind
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:697:5
  15:        0x100dd8840 - core::panicking::panic_fmt::h529fda7ea817ba4f
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/panicking.rs:75:14
  16:        0x100db2828 - wgpu_native::default_uncaptured_error_handler::hf25de64590a009b9
  17:        0x10091412c - wgpu_native::ErrorSinkRaw::handle_error::hbcb9f29bd6a0e02d
  18:        0x1009153f4 - wgpu_native::handle_error::h17fb39ef39ca376f
  19:        0x1009261e4 - _wgpuRenderPassEncoderEnd
  20:        0x100884828 - game::renderpass_end
                               at /Users/lily/Documents/repos/eel-pool/src/render.odin:118:2
  21:        0x1008860a0 - game::wgpu_frame_end
                               at /Users/lily/Documents/repos/eel-pool/src/wgpu.odin:179:2
  22:        0x1008840e4 - game::app_update
                               at /Users/lily/Documents/repos/eel-pool/src/app.odin:119:2
  23:        0x100883770 - game::app_run
                               at /Users/lily/Documents/repos/eel-pool/src/app.odin:98:8
  24:        0x1008c49ac - main::main
                               at /Users/lily/Documents/repos/eel-pool/src/entry/game/main.odin:12:2
  25:        0x1008b19fc - main
                               at /Users/lily/.local/share/mise/installs/asdf-jtakakura-asdf-odin/dev-2025-08/bin/base/runtime/entry_unix.odin:57:4

thread '<unnamed>' panicked at library/core/src/panicking.rs:218:5:
panic in a function that cannot unwind
stack backtrace:
   0:        0x100d60bf8 - std::backtrace_rs::backtrace::libunwind::trace::hd09570c029a6744a
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/../../backtrace/src/backtrace/libunwind.rs:117:9
   1:        0x100d60bf8 - std::backtrace_rs::backtrace::trace_unsynchronized::h8d2fa64833f91cb3
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/../../backtrace/src/backtrace/mod.rs:66:14
   2:        0x100d60bf8 - std::sys::backtrace::_print_fmt::h567d2a106a3b0dee
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/sys/backtrace.rs:66:9
   3:        0x100d60bf8 - <std::sys::backtrace::BacktraceLock::print::DisplayBacktrace as core::fmt::Display>::fmt::h92dda645f072dcaf
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/sys/backtrace.rs:39:26
   4:        0x100da0c90 - core::fmt::rt::Argument::fmt::hc0b28dad2d7b7ba8
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/fmt/rt.rs:184:76
   5:        0x100da0c90 - core::fmt::write::hbc92919d8e8f9a96
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/fmt/mod.rs:1481:21
   6:        0x100d56c28 - std::io::default_write_fmt::h0768ab719ca8b5cc
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/io/mod.rs:639:11
   7:        0x100d56c28 - std::io::Write::write_fmt::hcee3b5dc9ab531be
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/io/mod.rs:1914:13
   8:        0x100d60aac - std::sys::backtrace::BacktraceLock::print::h0f497abce563e5d2
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/sys/backtrace.rs:42:9
   9:        0x100d62dc8 - std::panicking::default_hook::{{closure}}::h62595143a6c21f05
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:300:22
  10:        0x100d62c18 - std::panicking::default_hook::hd800536ed1df5085
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:327:9
  11:        0x100d63940 - std::panicking::rust_panic_with_hook::h1882a30575fbb763
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:833:13
  12:        0x100d63544 - std::panicking::begin_panic_handler::{{closure}}::h39275ef3005e6337
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:699:13
  13:        0x100d610a8 - std::sys::backtrace::__rust_end_short_backtrace::h6ede323c05a76849
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/sys/backtrace.rs:168:18
  14:        0x100d63214 - __rustc[95feac21a9532783]::rust_begin_unwind
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/std/src/panicking.rs:697:5
  15:        0x100dd8874 - core::panicking::panic_nounwind_fmt::runtime::hcbc23776d9f6f115
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/panicking.rs:117:22
  16:        0x100dd8874 - core::panicking::panic_nounwind_fmt::hae736249e48cf020
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/intrinsics/mod.rs:3241:9
  17:        0x100dd88ec - core::panicking::panic_nounwind::hb89b2a5de4429251
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/panicking.rs:218:5
  18:        0x100dd8a90 - core::panicking::panic_cannot_unwind::h620b5c02cb97e1cc
                               at /rustc/17067e9ac6d7ecb70e50f92c1944e545188d2359/library/core/src/panicking.rs:323:5
  19:        0x100db2858 - wgpu_native::default_uncaptured_error_handler::hf25de64590a009b9
  20:        0x10091412c - wgpu_native::ErrorSinkRaw::handle_error::hbcb9f29bd6a0e02d
  21:        0x1009153f4 - wgpu_native::handle_error::h17fb39ef39ca376f
  22:        0x1009261e4 - _wgpuRenderPassEncoderEnd
  23:        0x100884828 - game::renderpass_end
                               at /Users/lily/Documents/repos/eel-pool/src/render.odin:118:2
  24:        0x1008860a0 - game::wgpu_frame_end
                               at /Users/lily/Documents/repos/eel-pool/src/wgpu.odin:179:2
  25:        0x1008840e4 - game::app_update
                               at /Users/lily/Documents/repos/eel-pool/src/app.odin:119:2
  26:        0x100883770 - game::app_run
                               at /Users/lily/Documents/repos/eel-pool/src/app.odin:98:8
  27:        0x1008c49ac - main::main
                               at /Users/lily/Documents/repos/eel-pool/src/entry/game/main.odin:12:2
  28:        0x1008b19fc - main
                               at /Users/lily/.local/share/mise/installs/asdf-jtakakura-asdf-odin/dev-2025-08/bin/base/runtime/entry_unix.odin:57:4
thread caused non-unwinding panic. aborting.
Finished in 1.16s
[diagnostic] ERROR task failed
```

# Sun Aug 24 2025

- [ ] Design the database for the game systems
  - Inspiration: <https://www.youtube.com/watch?v=8WqYQ1OwxJ4>

# Sun Sep 07 2025

Indie-Style 6-Frame Walk Cycle Animation

This guide creates a complete, looping walk cycle using 6 keyframes optimized for indie games. The animation alternates between left and right foot contacts for natural, seamless looping.

## Frame 1: Left Contact - Impact
**Action**: Left foot strikes ground with full body weight transfer
- Left leg extended forward, foot planted firmly
- Body shows compression from impact - slight crouch
- Right foot lifting off ground behind
- Arms: Right arm forward, left arm back (opposing motion)
- **Key pose** - Hold this frame longer (200ms)

## Frame 2: Left Push - Compression
**Action**: Body settles and prepares to spring forward
- Left leg compressed, absorbing weight
- Right leg swings up, knee bent high
- Body at lowest point in cycle
- Torso leans slightly forward with momentum
- Arms: Right arm pulls back to neutral, left arm swings toward forward position

## Frame 3: Mid-Stride - Suspension
**Action**: Peak energy release, both feet off ground
- Right leg swinging forward at highest arc
- Left leg pushing off, beginning to lift
- Body at highest point, slight forward lean
- Maximum arm extension in opposing directions
- **Key pose** - Emphasizes stylized floating moment

## Frame 4: Right Contact - Impact
**Action**: Right foot strikes ground (mirror of Frame 1)
- Right leg extended forward, foot planted firmly
- Body shows compression from impact
- Left foot lifting off ground behind
- Arms: Left arm forward, right arm back
- **Key pose** - Hold this frame longer (200ms)

## Frame 5: Right Push - Compression
**Action**: Body settles and prepares to spring forward (mirror of Frame 2)
- Right leg compressed, absorbing weight
- Left leg swings up, knee bent high
- Body at lowest point in cycle
- Torso leans slightly forward
- Arms: Left arm pulls back to neutral, right arm swings toward forward position

## Frame 6: Mid-Stride - Suspension
**Action**: Peak energy release, preparing for left contact (mirror of Frame 3)
- Left leg swinging forward at highest arc
- Right leg pushing off, beginning to lift
- Body at highest point, loops back to Frame 1
- Maximum arm extension
- **Key pose** - Creates anticipation for loop restart

**Animation Philosophy**: Emphasize the **contact** and **suspension** moments. These are your money shots - the impact frames (1,4) show weight and power, while suspension frames (3,6) show grace and style.

## Aseprite Implementation Guide

### Layer Organization
Create separate layers for better control and editing:
- **Background** - Static background elements (optional)
- **Body** - Main torso and head
- **Arms** - Both arms on same layer for simplicity
- **Legs** - Both legs on same layer
- **Details** - Hair, clothing details, accessories

### Frame Setup
1. Set your sprite to 6 frames total
2. Frame timing for indie feel:
   - Frames 1,4 (contacts): 200ms - emphasize impact
   - Frames 2,5 (compression): 100ms - quick transition
   - Frames 3,6 (suspension): 250ms - stylized hang time
3. Use onion skinning (previous/next frame visibility) to maintain consistency between frames

### Animation Tags
Create an animation tag for organization:
1. Go to **Frame → Tags**
2. Create tag covering frames 1-6
3. Name it "walk_cycle"
4. Set direction to "Forward" for continuous looping

### Workflow Tips
- **Work in passes**: Complete all 6 frames for one body part before moving to the next
- **Mirror workflow**: Frames 4-6 mirror frames 1-3, saving time on poses
- **Use reference layer**: Set frame 1 as reference when working on other frames
- **Preview frequently**: Use spacebar to play animation and check flow
- **Export settings**: Use "Save As" → GIF to test your animation loop

### Advanced Features to Explore
- **Cel linking**: Link identical elements across frames to save time
- **Animation curves**: Adjust frame timing for more natural motion
- **Tilemap mode**: Useful if character will walk across repeating ground tiles

# Sat Sep 13 2025

TODO: Debug text stack that allows for in-game modification of the text stack

Display text starting at the top left of the screen.
For each call to debug_text_stack, add a new row to the stack.
Use this to print out value of select vars across frames.

# Fri Sep 26 2025 - 1

  ✅ Already Implemented

  - Linear algebra (comprehensive Vec2/3/4 + integer variants)
  - Geometry primitives (lines, rays, circles, spheres, AABB)
  - SDL3 integration (window, input, rendering)
  - Asset management (sprites, animations, tilemaps from JSON)
  - Game loop & timing (fixed timestep with accumulator)
  - Animation system (frame-based with delays)
  - Basic input handling (keyboard, mouse with configurable bindings)
  - Configuration system (CLI parsing, logger config)
  - Level loading (JSON-based tilemap system)
  - Entity behaviors (range-activated missile pattern)

  📋 Missing/Incomplete but Essential

  Audio System

  - Sound effect playback
  - Music streaming
  - Volume control

  Enhanced Physics

  - Collision response (you have detection via geometry)
  - Gravity/acceleration systems beyond missiles
  - Physics materials/friction

  Memory Management

  - Object pooling for entities/projectiles
  - Custom allocators for game objects
  - Memory profiling tools

  Enhanced Entity System

  - Multiple enemy types/behaviors
  - Entity lifecycle management
  - Component composition system

  UI System

  - Game menus/HUD
  - Settings screens
  - Debug overlay system

  Particle Systems

  - Explosion effects
  - Environmental particles
  - Trail/smoke effects

  Camera System

  - World-to-screen transformations
  - Camera following/tracking
  - Screen shake effects

  Scene Management

  - Multiple game states (menu, playing, paused)
  - Scene transitions
  - Level progression system

  Advanced Rendering

  - Rendering to an intermediate texture
  - Z-ordering/layers
  - Post-processing effects
  - Lighting system

  Debugging Tools

  - Visual collision debugging
  - Performance profiler
  - Entity inspector
  - Console commands

  Game-Specific Features

  - Health/damage systems
  - Inventory/items
  - Save/load system
  - Score tracking

# Sat Sep 27 2025 - 2

TODO: Render game to an intermediate texture. Render layers to the intermediate texture. Render the intermediate texture to the screen.

# Sat Sep 27 2025

- [x] Render lines and shape primitives for debug purposes
  - draw line, draw aabb, draw circle, etc
- [ ] Render text for debug purposes
